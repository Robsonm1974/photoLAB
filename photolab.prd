# PhotoLab - Product Requirements Document (PRD)

## ğŸ“‹ VISÃƒO GERAL

### **Objetivo**
PhotoLab Ã© uma aplicaÃ§Ã£o desktop multiplataforma que automatiza a organizaÃ§Ã£o de fotos de eventos escolares, integrando-se ao SaaS PhotoManager para criar estruturas de pastas fÃ­sicas baseadas em detecÃ§Ã£o de QR codes. 

### **Problema a Resolver**
FotÃ³grafos escolares gastam horas organizando manualmente milhares de fotos por evento, criando estruturas de pastas e renomeando arquivos para associar fotos aos participantes corretos.

### **SoluÃ§Ã£o**
AplicaÃ§Ã£o desktop que:
- LÃª lista CSV de participantes
- Cria estrutura de pastas organizada
- Detecta QR codes automaticamente nas fotos
- Copia e renomeia arquivos JPG
- Gera relatÃ³rios de processamento

---

## ğŸ¯ ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS

### **Arquitetura**
```
Frontend: Electron + React + Tailwind CSS
Backend: Node.js (APIs internas)
Processamento: Python scripts (OCR + Computer Vision)
Banco Local: SQLite (cache e configuraÃ§Ãµes apenas)
```

### **Stack Detalhada**
```javascript
// Frontend
- Electron ^27.0.0
- React ^18.2.0
- Tailwind CSS ^3.4.0
- Lucide React (Ã­cones)
- React Hook Form (formulÃ¡rios)

// Backend/Processamento  
- Node.js ^20.0.0
- Python ^3.11
- OpenCV-Python (detecÃ§Ã£o QR)
- Pillow (manipulaÃ§Ã£o imagens)
- Pandas (CSV handling)
- SQLite3 (cache local)
```

### **Compatibilidade**
- **Windows:** 10/11 (x64)
- **macOS:** 10.15+ (Intel/Apple Silicon)
- **Linux:** Ubuntu 20.04+ (x64)

---

## ğŸ—ï¸ ARQUITETURA DE ARQUIVOS

### **Estrutura do Projeto**
```
photolab/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/                    # Processo principal Electron
â”‚   â”‚   â”œâ”€â”€ main.js
â”‚   â”‚   â”œâ”€â”€ preload.js
â”‚   â”‚   â””â”€â”€ menu.js
â”‚   â”œâ”€â”€ renderer/               # Interface React
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Forms/
â”‚   â”‚   â”‚   â”œâ”€â”€ Progress/
â”‚   â”‚   â”‚   â””â”€â”€ Reports/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ Home.jsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Processing.jsx
â”‚   â”‚   â”‚   â””â”€â”€ Reports.jsx
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”œâ”€â”€ python/                 # Scripts de processamento
â”‚   â”‚   â”œâ”€â”€ qr_detector.py
â”‚   â”‚   â”œâ”€â”€ file_organizer.py
â”‚   â”‚   â”œâ”€â”€ csv_parser.py
â”‚   â”‚   â””â”€â”€ report_generator.py
â”‚   â””â”€â”€ assets/
â”œâ”€â”€ public/
â”œâ”€â”€ build/
â”œâ”€â”€ dist/
â”œâ”€â”€ package.json
â”œâ”€â”€ electron-builder.json
â””â”€â”€ requirements.txt
```

---

## ğŸ”„ FLUXO DE FUNCIONAMENTO

### **1. InicializaÃ§Ã£o**
```
1. Verificar licenÃ§a PhotoManager (online)
2. Carregar configuraÃ§Ãµes locais
3. Mostrar interface principal
```

### **2. Input do UsuÃ¡rio**
```
1. Selecionar arquivo CSV (participantes)
2. Selecionar pasta origem (fotos cruas)
3. Inserir nome do evento
4. ConfiguraÃ§Ãµes opcionais:
   - Formatos aceitos (.jpg, .jpeg)
   - Pasta destino (padrÃ£o: mesma da origem)
```

### **3. Processamento**
```
1. Validar CSV (colunas: nome, turma, qr_code)
2. Escanear pasta origem (apenas JPGs)
3. Criar estrutura de pastas baseado na lista CSV:
   ...PastaDeOrigem/NomeEvento/Turma/ParticipanteNome-QRCode/
4. Executar detecÃ§Ã£o OCR em lote:
   - Detectar QR codes nas fotos
   - Agrupar por proximidade temporal
   - Associar aos participantes da lista
5. Tratar erros - fazer associacao, inserir QR code, manualmente
6.Copiar e renomear arquivos:
   original.jpg â†’ original_QRCode.jpg
67. Gerar relatÃ³rio final
```

### **4. Output**
```
ğŸ“ Estrutura organizada fisicamente
ğŸ“‹ RelatÃ³rio HTML/PDF
ğŸ“Š Log de operaÃ§Ãµes
âš ï¸ Lista de problemas encontrados
```

---

## ğŸ“Š FUNCIONALIDADES DETALHADAS

### **Core Features**

#### **ğŸ” DetecÃ§Ã£o de QR Codes**
```python
EspecificaÃ§Ãµes:
- Algoritmo: OpenCV + pyzbar
- Formatos: QR Code padrÃ£o
- PrecisÃ£o: >95% em condiÃ§Ãµes normais
- Fallback: Interface manual para correÃ§Ãµes
```

#### **ğŸ—‚ï¸ OrganizaÃ§Ã£o de Arquivos**
```java/type script
Estrutura Final:
ğŸ“ [NomeEvento]/
â”œâ”€â”€ ğŸ“ [Turma1]/
â”‚   â”œâ”€â”€ ğŸ“ [NomeParticipante1 - QR123456]/
â”‚   â”‚   â”œâ”€â”€ IMG001_QR123456.jpg
â”‚   â”‚   â”œâ”€â”€ IMG002_QR123456.jpg
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ ğŸ“ [NomeParticipante2 - QR789012]/
â””â”€â”€ ğŸ“ [Turma2]/
```

#### **ğŸ“‹ Sistema de RelatÃ³rios**
```html
RelatÃ³rio HTML inclui:
- EstatÃ­sticas gerais (total fotos, participantes)
- Taxa de sucesso OCR
- Lista de participantes processados
- Problemas encontrados
- Tempo de processamento
- Timestamp e versÃ£o do PhotoLab
```


### **Interface Features**

#### **ğŸ¨ UI/UX Requirements**
```css
Design System:
- Tema: Moderno, clean, profissional
- Cores: Azul primÃ¡rio, cinza neutro, verde sucesso
- Tipografia: Inter/System fonts
- Layout: Responsivo (mÃ­nimo 1024x768)
- Componentes: shadcn/ui style
```

#### **ğŸ“± Telas Principais**

**Tela 1: Setup**
```jsx
Componentes:
- File picker para CSV
- Folder picker para origem
- Input texto para nome evento
- BotÃ£o "Iniciar Processamento"
- Preview da lista CSV (primeiras 5 linhas)
```

**Tela 2: Processamento**
```jsx
Componentes:
- Progress bar animada
- EstatÃ­sticas em tempo real
- Log de atividades (scrollable)
- BotÃ£o "Cancelar" (se necessÃ¡rio)
- Preview das fotos sendo processadas
```

**Tela 3: Resultados**
```jsx
Componentes:
- Resumo estatÃ­stico
- Lista de sucessos/problemas
- BotÃµes: "Ver RelatÃ³rio", "Abrir Pasta", "Novo Evento"
- Preview da estrutura criada
```
**Tela 4: Erros**
```jsx
Componentes:
- IdentificaÃ§Ã£o manual - De um lado as fotos nao identificadas, do outro lado, campo para associar/entrar qrcode
- Tela carrega fotos nao identificadas em ordem, e permite selecionar o grupo, e inserir o qr code para o grupo
- BotÃµes: "TextBOx para o qrcode", "Inserir QR code", "Novo Evento"
- Preview das fotos identificadas e mostra dos resultado.... (...100% das fotos identificadas)
```

---

## ğŸ” SISTEMA DE LICENCIAMENTO

### **IntegraÃ§Ã£o PhotoManager**

#### **Endpoint Requerido (PhotoManager)**
```php
// Endpoint: /api/photolab-license.php
{
  "user_id": "string",
  "active": boolean,
  "plan": "free|basic|pro", 
  "photos_limit": number,
  "photos_used": number,
  "events_limit": number,
  "events_used": number
}
```

#### **VerificaÃ§Ã£o (PhotoLab)**
```javascript
Momento da verificaÃ§Ã£o:
1. Ao inicializar aplicaÃ§Ã£o
2. A cada 24 horas (background)
3. Antes de processar evento

Comportamento:
- LicenÃ§a OK: Funcionalidade completa
- Limite atingido: Bloquear processamento
- Sem internet: Permitir por 24h (grace period)
- LicenÃ§a invÃ¡lida: Modo somente visualizaÃ§Ã£o
```

### **Limites por Tier**
```
Segue os limites da assinatura do Photomanager, verifica se no photomanager estÃ¡ ok, se ok aqui funciona, senao congela.

---

## ğŸš€ REQUISITOS DE PERFORMANCE

### **Benchmarks**
```
Volume de Teste: 5.000 fotos JPG (mÃ©dia 3MB cada)
- Tempo OCR: < 10 minutos
- Tempo cÃ³pia: < 5 minutos  
- MemÃ³ria RAM: < 1GB durante processamento
- CPU: Multithreading (usar todos os cores)
```

### **OtimizaÃ§Ãµes**
```python
EstratÃ©gias:
1. Processamento paralelo (Pool de workers)
2. Cache de OCR (nÃ£o reprocessar)
3. Batch operations (copiar em lotes)
4. Progress incremental (feedback visual)
5. InterrupÃ§Ã£o graceful (cancelar operaÃ§Ã£o)
```

---

## ğŸ› ï¸ INSTALAÃ‡ÃƒO E DISTRIBUIÃ‡ÃƒO

### **Instaladores Nativos**
```json
Electron Builder config:
- Windows: NSIS installer (.exe)
- macOS: DMG + auto-update  
- Linux: AppImage + .deb

Features:
- Auto-updater integrado
- Desktop shortcut
- Menu start integration
- Uninstaller incluÃ­do
```

### **DependÃªncias Python**
```python
InstalaÃ§Ã£o automÃ¡tica:
- Python runtime embarcado
- OpenCV, Pillow, pandas
- Sem necessidade de Python no sistema
```

---

## ğŸ“‹ CASOS DE USO

### **CenÃ¡rio TÃ­pico**
```
Contexto: SessÃ£o de fotos escolar
- 300 participantes 
- 2.500 fotos totais
- 15 turmas
- Tempo manual atual: 8 horas
- Tempo com PhotoLab: 30 minutos
```

### **Edge Cases**
```
1. QR code nÃ£o detectado:
   - Mostrar foto na interface
   - Permitir input manual do cÃ³digo
   
2. MÃºltiplos participantes em uma foto:
   - Priorizar primeiro QR code detectado
   - Log para revisÃ£o manual

3. Participante sem fotos:
   - Criar pasta vazia
   - Alertar no relatÃ³rio

4. Arquivo corrompido:
   - Pular arquivo
   - Log do erro
```

---

## ğŸ” CRITÃ‰RIOS DE ACEITAÃ‡ÃƒO

### **Funcional**
- âœ… DetecÃ§Ã£o QR code > 90% precisÃ£o
- âœ… Processamento 1.000 fotos < 15min
- âœ… Zero perda de arquivos originais
- âœ… Estrutura de pastas correta 100%
- âœ… RenomeaÃ§Ã£o de arquivos consistente
- âœ… RelatÃ³rio gerado sempre
- âœ… VerificaÃ§Ã£o de licenÃ§a funcional

### **TÃ©cnico**
- âœ… InstalaÃ§Ã£o < 5 minutos
- âœ… Interface responsiva (> 60fps)
- âœ… Tratamento de erros robusto
- âœ… Log detalhado de operaÃ§Ãµes
- âœ… Cancelamento de operaÃ§Ãµes
- âœ… Auto-updater funcional

### **Usabilidade**
- âœ… Setup em < 3 cliques
- âœ… Feedback visual constante
- âœ… Mensagens de erro claras
- âœ… DocumentaÃ§Ã£o inclusa
- âœ… Suporte a teclado/atalhos

---

## ğŸ¯ ROADMAP DE LANÃ‡AMENTO - PRIORIDADE DEFINIDA

### **ğŸš€ PRIMEIRA ENTREGA - MVP Core (Semana 1)**
**Funcionalidades Cruciais:**
```
PRIORIDADE 1 - Escolha do diretÃ³rio origem
- Interface file picker para pasta
- ValidaÃ§Ã£o: pasta existe e contÃ©m JPGs
- Display path selecionado
- Contagem prÃ©via de arquivos JPG

PRIORIDADE 2 - Carregar lista participantes CSV  
- File picker para arquivo CSV
- Parser e validaÃ§Ã£o (nome, turma, qr_code)
- Preview primeiras 5 linhas
- ValidaÃ§Ã£o QR codes Ãºnicos
- Export dados para processamento

PRIORIDADE 3 - Criar diretÃ³rios baseado na lista
- SanitizaÃ§Ã£o nomes (caracteres especiais)
- Estrutura: /Evento/Turma/Participante-QRCode/
- VerificaÃ§Ã£o permissÃµes escrita
- CriaÃ§Ã£o Ã¡rvore completa de diretÃ³rios
```

### **âš¡ SEGUNDA ENTREGA - Processamento OCR (Semana 2-3)**
**Funcionalidade Mais Complexa:**
```
PRIORIDADE 4 - DetecÃ§Ã£o QR codes (CORE COMPLEXO)

4.1 - OCR Detection Engine:
    â€¢ OpenCV + pyzbar setup
    â€¢ Pipeline otimizado para QR detection
    â€¢ Cache resultados para performance
    â€¢ Confidence scoring

4.2 - Sequenciamento de Fotos:  
    â€¢ Identificar primeira foto (QR visible)
    â€¢ Agrupar fotos atÃ© prÃ³ximo QR aparecer
    â€¢ Algoritmo temporal proximity
    â€¢ Tratamento edge cases

4.3 - Painel ConfirmaÃ§Ã£o Manual:
    â€¢ Interface para QR codes nÃ£o detectados
    â€¢ Preview da foto + input manual QR
    â€¢ Lista participantes sem fotos
    â€¢ Batch correction interface

4.4 - CÃ³pia e RenomeaÃ§Ã£o:
    â€¢ Copy JPGs para pastas corretas  
    â€¢ Rename: original_QRcode.jpg
    â€¢ Preservar metadados EXIF
    â€¢ Progress tracking em tempo real
```

### **ğŸ” TERCEIRA ENTREGA - Licenciamento (Semana 4)**
```
PRIORIDADE 5 - VerificaÃ§Ã£o licenÃ§a funcional
- IntegraÃ§Ã£o PhotoManager API
- Cache licenÃ§a local
- Enforcement limits (fotos/eventos)
- Interface status assinatura
- Modo offline (grace period 24h)
```

### **ğŸ“Š QUARTA ENTREGA - RelatÃ³rios (Semana 5)**
```
PRIORIDADE 6 - Sistema relatÃ³rios
- RelatÃ³rio HTML standalone
- EstatÃ­sticas processamento
- Lista problemas encontrados  
- Export logs detalhados
```

---

## ğŸ“ SUPORTE E MANUTENÃ‡ÃƒO

### **Logs e Debug**
```javascript
Sistema de logs:
- Arquivo: ~/PhotoLab/logs/app.log
- RotaÃ§Ã£o: 7 dias
- NÃ­veis: ERROR, WARN, INFO, DEBUG
- Envio automÃ¡tico crashes (opcional)
```

### **AtualizaÃ§Ãµes**
```json
Auto-update:
- VerificaÃ§Ã£o: Startup + diÃ¡ria
- Download: Background
- InstalaÃ§Ã£o: ReinÃ­cio aplicaÃ§Ã£o
- Rollback: VersÃ£o anterior disponÃ­vel
```

---

## ğŸ”’ SEGURANÃ‡A E PRIVACIDADE

### **Dados Locais**
```
PrincÃ­pios:
- Fotos nunca enviadas online
- Processamento 100% local
- Cache OCR opcional (deletÃ¡vel)
- Logs sem dados pessoais
```

### **ComunicaÃ§Ã£o Externa**
```
Apenas para:
- VerificaÃ§Ã£o licenÃ§a PhotoManager
- Check updates aplicaÃ§Ã£o
- Telemetria bÃ¡sica (opcional)
```

---

*Este PRD serve como especificaÃ§Ã£o completa para desenvolvimento do PhotoLab v1.0*